<div class="container min-vh-100">

  <div class="row mt-5 d-flex">

    <div class="col-sm-12 col-md-4">
      <% if current_user.photo.attached? %>
        <%= cl_image_tag @user.photo.key, :width=>300, :height=>300, :gravity=>"face", :radius=>"max", :crop=>"fill", class:'avatar-profile'%>
      <% else %>
        <i class="fas fa-user-circle fa-2x" style="font-size: 200px"></i>
      <% end %>
    </div>
    <div class="col-sm-12 col-md-4">
      <% if @user == current_user  %>
        <h1><%= "#{@user.first_name} #{@user.last_name}" %></h1>
      <% else %>
        <h1><%= @user.first_name %></h1>
      <% end %>
        <% if @user == current_user %>
          <h4><%= IsoCountryCodes.find(@user.country.to_s).name %> <%= NormalizeCountry(@user.country, :to => :emoji)%></h4>
        <% else %>
          <h4><%= @user.country %> <%= NormalizeCountry(@user.country, :to => :emoji)%></h4>
        <% end %>
      <% if @reviews.present? %>
        <%= '<i class="fas fa-star"></i>'.html_safe * @rounded_average_of_ratings %><%= '<i class="far fa-star"></i>'.html_safe * (5-@rounded_average_of_ratings) %>
        <%= @average_of_ratings.round(1).to_f %>
      <% else %>
        <% if @user == current_user %>
          <p><em>You do not have any reviews yet</em></p>
        <% else %>
          <p><em>No reviews yet for <%= @user.first_name %></em></p>
        <% end %>
      <% end %>

      <% if @user == current_user %>
        <% if @user.reviews.count > 1 %>
          <p><i class="fas fa-pencil-alt"></i> You wrote <%= @user.reviews.count %> reviews.</p>
        <% elsif @user.reviews.count == 1 %>
          <p><i class="fas fa-pencil-alt"></i> You wrote <%= @user.reviews.count %> review.</p>
        <% else %>
          <p><i class="fas fa-pencil-alt"></i> You have not written any reviews yet.</p>
        <% end %>
      <% else %>
        <% if @user.reviews.count > 1 %>
          <p><i class="fas fa-pencil-alt"></i> <%= @user.first_name %> wrote <%= @user.reviews.count %> reviews.</p>
        <% elsif @user.reviews.count == 1 %>
          <p><i class="fas fa-pencil-alt"></i> <%= @user.first_name %> wrote <%= @user.reviews.count %> review.</p>
        <% else %>
          <p><i class="fas fa-pencil-alt"></i> <%= @user.first_name %> has not written any reviews yet.</p>
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="row mt-5">
    <div class="col-12">

      <% if @user == current_user %>
        <h2>My Listings (<%= @user.listings.count %>)</h2>
      <% else %>
        <h2><%= @user.first_name %>'s Listings (<%= @user.listings.count %>)</h2>
      <% end %>

      <% if user_signed_in? && @user == current_user %>
          <%= link_to '+ Add a listing', new_listing_path, class:"btn btn-primary" %>
      <% end %>

      <div class="card-deck">
        <% @user.listings.each do |listing| %>
          <%= render './shared/card', listing: listing %>
        <% end %>
      </div>
    </div>
  </div>

  <div class="row mt-5 mb-4">
    <div class="col-12">
      <% if @user == current_user %>
        <h2>My Purchases (<%= @user.purchases.count %>)</h2>
        <div class="card-deck">
          <% @user.purchases.each do |transaction|%>
            <%= render './shared/transaction_card', transaction: transaction %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="row mt-5 mb-5">
    <div class="col-12">
      <h2>What others think of the items <%= @user.first_name %> sold (<%= @reviews.count %>)</h2>
      <div class="cards-listing row d-flex justify-content-flex-start align-items-center">
        <% if @reviews.present? %>
          <% @reviews.each do |review|%>
            <%= render './shared/review_card', review: review %>
          <% end %>
        <% else %>
          <p><em><%= @user.first_name %> has no reviews yet.</em></p>
        <% end %>
      </div>
    </div>
  </div>
</div>

<!-- # if user is equal to current_user,
# we will show the users reviews, listings and transactions
# else we only show reviews and listings
 -->


  <!-- # if user is equal to current_user,
  # we will show the users reviews, listings and transactions
  # else we only show reviews and listings
  -->
